# ファイル操作

* ファイルシステムについて
* ファイルの読み込み
* CSVファイルの扱い
* データ解析

## ファイルとは何か

Pythonなどのスクリプト言語を使えるようになると、使えない場合に比べて飛躍的に作業効率が上がる。特に、大量のファイルを解析、変換したいといった場合に、一つ一つエクセルで開いては作業する人に比べて、Pythonその他スクリプト言語とシェルスクリプト等を組み合わせて処理できる人は、生産性に圧倒的な差が出てしまう。そこで、今回はPythonでCSVファイルを開いて、データの解析を行う。しかし、まずその前に「そもそもファイルとは何か」を知っているだろうか？

我々がコンピューターを使う際、何気なくファイルを触っている。スマートフォンで以前撮影した写真を見てみたり、ダウンロードした音楽を聞いたりしている時、意識はしていないかもしれないが、裏ではアプリケーションが写真ファイルや音楽ファイルを開いて読み込み、再生している。また、パソコンで、デスクトップにあるファイルをダブルクリックして開いたり、「あのファイルどこにやったかな」とディレクトリを探し回ったりしたことがあるだろう。スマホでもパソコンでも、何かデータにアクセスする際は、ほとんどの場合においてファイルの読み書きという形をとっている。ファイルの実体は、例えばハードディスクやSDカードに記録されたデータであり、両者は物理的には全く異なるアクセスをしているにも関わらず、保存先がハードディスクであってもSDカードであっても、同じようにアクセスすることができ、我々はその裏で何が起きているのかを意識することはほとんどない。それは、オペレーティングシステムが、「ファイルを管理する」という面倒な作業を代わりにやってくれているからだ。このファイルを管理する仕組みを「ファイルシステム」と呼ぶ。

おそらく、今後の人生でファイルシステムの知識が必要になることはほとんどないであろう。必要になるとしても、せいぜい「SDカードやUSBメモリをフォーマットする時に、ファイルシステムの種類に気を付けないとWindowsとMacで互換性の問題が起きる」といった程度で、ファイルシステムの仕組みや動作について知っていても役に立つことはないと思われる。しかし、役に立つ、立たないは別として、普段使っているパソコンやスマホの裏で、「ファイル」や「フォルダ」がどのような仕組みで管理されているか知っておいても良いであろう。それが教養というものである。

## ファイルシステムについて

ファイルシステムとは、ハードディスクやSDカード、USbメモリといった記憶装置にデータを読み書きするための仕組みである。これらの記憶装置は物理的にはいろいろ違いがあるものの、非常に単純化してしまえば一冊の巨大なノートのようなものだ。データの読み書きは「クラスタ」もしくは「ブロック」というまとまった単位で行われる。一般的にクラスタやブロックのサイズは4KBであることが多く、1バイトの小さなファイルであっても、ディスクの上では4KB消費する。これは、ページに余白が多く残っても、次の日の日記は次のページに書くようなものである。

さて、もしファイルシステムがなければ、「どのページに何を書いたか」をすべて覚えておかなければならない。ページ数が多いと後から欲しい内容を探すのが大変になるので、ページに付箋を貼って短いタイトルをつけたくなるであろう。また、あるページが不要になって内容を消去したら、そのページを後から再利用したいが、書いたり消したりを繰り返していると「空きページ」が飛び飛びになり、「意味としては連続した内容」が、「ディスクの上では飛び飛び」に保存されてしまったりする。これらをプログラマの責任で管理するのは大変である。この、ページに付箋をつけて後から探しやすくしたり、物理的には不連続な情報を論理的には連続に見せてくれるような仕組みを提供してくれるのがファイルシステムである。


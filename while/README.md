# 条件分岐と繰り返し処理2

* 前回の復習
* 変数とは何か？
* while文
* Collatz問題

## 前回の復習

* 基本型
* 条件分岐
* 繰り返し処理
* 関数
* インデントによるブロック表現

## 変数とは何か？

TODO: idやtypeの説明

## While文

## Collatz問題

ではさっそくwhile文を使ってプログラムを作ってみよう。題材としてCollatz問題を取り上げる。
Collatz問題とは、以下のようなものである。

* 何か正の整数を考えよ
* それが偶数なら2で割れ
* それが奇数なら3倍して1を足せ
* 以上の処理を数字が1になるまでずっと繰り返せ

たとえば「5」を考えよう。これは奇数なので3倍して1を足すと「16」になる。
これは偶数だから2で割って「8」、さらに2で割って「4」「2」「１」となる。

Collatz問題とは「すべての整数について有限回の手続きで1になるか？」というものであり、現在も解決されていない。
もし有限の手続きで1にならないとしたら、どこかに無限に大きくなるか、ループする構造があるはずだが、今の所どちらも見つかっていない。

### 課題1

与えられた数字に対して、

* 偶数なら2でわる
* 奇数なら3倍して1を足す

という処理を、その数字が1になるまで繰り返しながら表示する関数`collatz`を作りたい。
以下の空欄を埋めよ。

```py
def collatz(i):
  print(i)
  while (条件1):
    if (条件2):
      i = i //2
    else:
      i = i * 3 + 1
    print(i)
```

インデントに注意。最初の`print`と二番目の`print`はインデントの位置が異なる。

完成したら、関数を入力したセルを実行してから、別のセルに以下のように関数呼び出しを入力、実行し、結果が一致することを確認せよ。

```py
collatz(3)
```

```sh
3
10
5
16
8
4
2
1
```

いろいろな数字を入れて、すべて最終的に1になることを確認せよ。収束するまでの手続きが長い数を探せ。例えば27を入れたらどうなるか。

### 課題2

Collatz問題をグラフで可視化してみよう。新しいノートブックを開き、以下のプログラムを4つのセルにわけて入力せよ。

1つ目のセル。

```py
from graphviz import Digraph
import IPython
```

2つ目のセル。

```py
def collatz(i, edges):
    while (条件1):
        j = i
        if (条件2):
            i = i // 2
        else:
            i = i * 3 + 1
        edges.add((j, i))
```

3つ目のセル。

```py
def make_graph(n):
    g = Digraph(format='png')
    edges = set()
    for i in range(1, n+1):
        collatz(i, edges)
    for i, j in edges:
        g.edge(str(i), str(j))
    g.graph_attr.update(size="10,10")
    g.render("test")
```

4つ目のセル。

```py
make_graph(3)
IPython.display.Image("test.png")
```

成功したら、いろんな数字を`make_graph`に入れて実行してみよ。20ぐらいがちょうどよいと思うが、27に挑戦してもよい。
Collatz予想とは、このグラフが木構造、つまりループ構造が無いことを主張するものである。

### 課題3

Collatz予想には様々な変種がある。例えば、

* 何か正の整数を考えよ
* それが偶数なら2で割れ
* それが奇数なら3倍して **3** を足せ
* 以上の処理を数字が **1か3** になるまでずっと繰り返せ

というものである。これもやはり有限回の手順で止まるらしい(おそらくこちらも未解決問題)。これを確認してみよう。

まず、先程課題2で作成した課題に名前をつけて保存しよう。ファイルメニューから「名前を変更」をクリック、もしくは上の「Untitled.ipynb」をクリックし、「collatz.ipynb」と名前を変えよう。その後、「ファイル」メニューの「保存」を選ぶと保存される。

この状態で「ファイル」メニューから「ドライブで探す」をクリックせよ。「マイドライブ」の「Colab Notebooks」に「collatz.ipynb」があるはずである。それを右クリックし「コピーを作成」を選ぶと「collatz.ipynbのコピー」というファイルが作成されるので、それを右クリックして「名前を変更」を選び、「collatz2.ipynb」という名前にしよう。「collatz2.ipynb」が作成されたら、右クリック→「アプリで開く」→「Colaboratory」を選ぶことで開くことができる。

「collatz2.ipynb」がGoogle Colabで開かれたら、

* 数字が1か3になったら終了とする
* 奇数だったら3倍して3を足す

となるように修正せよ。

修正したら、例えば`make_graph(5)`として、1に収束する数字と3に収束する数字があることを確認せよ。
`make_graph(50)`ではどうなるか？1に収束するのはどういう数字か？

## 余談：整数論について

